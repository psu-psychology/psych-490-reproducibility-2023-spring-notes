# (PART) R Code {-} 

# Survey 1 results {- #survey_01_results}

## Purpose {-}

This document summarizes the analysis of data for Survey 1 on scientific norms and counter-norms (https://forms.gle/1zqzfNNXWyCgiDSJ9).

This survey is part of the class discussion of [adherence to norms and counternorms](adherence-to-norms-and-counter-norms.html).

## Background {-}

The survey questions were derived from the Appendix in [[@Kardash2012-kq]](https://doi.org/10.1007/s11251-011-9195-0).
We thank these authors for publishing the survey questions in their article so that we could reuse them for our class.

## Set-up {-}

```{r set-up-survey-results, include = FALSE}
# Defaults for chunks, especially figures
knitr::opts_chunk$set(echo = TRUE,
                      out.width = "75%")
```

We load the required R packages.

```{r survey-1-setup, e}
suppressPackageStartupMessages(library("tidyverse")) # for pipe %>%
suppressPackageStartupMessages(library("googledrive"))
suppressPackageStartupMessages(library("magrittr"))
suppressPackageStartupMessages(library("dplyr"))
suppressPackageStartupMessages(library("ggplot2"))
```

## Download data {-}

Download the data file from the spreadsheet generated by the Google Form into a comma-separated value (CSV) file in a local directory called `csv/`.

Authenticate to Google.

```{r, eval=FALSE}
googledrive::drive_auth(email = "rick.o.gilmore@gmail.com")
```

```{r}
if (!dir.exists('csv')) {
  dir.create('csv')
}

csv_fn <- "csv/psych-490-2023-spring-survey-01.csv"
```

```{r, eval=FALSE}
googledrive::drive_download(file = 'PSYCH 490.002 Survey 1 (Responses)', path = csv_fn, type = 'csv', overwrite = TRUE)
```

## Clean data {-}

Load the data file.

```{r}
if (file.exists(csv_fn)) {
  survey_01 <- readr::read_csv(csv_fn, show_col_types = FALSE)
} else {
  message("File not found: ", csv_fn)
  survey_01 <- NULL
}
```

Examine the data set as a whole.

```{r}
str(survey_01)
```

Examine the variable names.

```{r}
if (is.null(survey_01)) {
  warning("Error loading data file")
} else {
  names(survey_01)
}
```

These variable names are too long to be useful.
Let's look at the source publication [[@Kardash2012-kq]](https://doi.org/10.1007/s11251-011-9195-0) to see if we can simplify them in a useful way.

So, the Appendix labels each question with a short phrase and notes whether the concept is a norm (N) or counter-norm (CN).
Let's rename the variables using the single words.

```{r}
new_names <-
  c(
    "Timestamp",
    "Disinterestedness",
    "Organized Skepticism",
    "Particularism",
    "Communality",
    "Organized Dogmatism",
    "Self-interestedness",
    "Universalism",
    "Solitariness",
    "Comments"
  )

# Make new data frame with long and short names for reference
survey_qs <- tibble(q_long = names(survey_01), q_short = new_names)

# Swap out old (long) names for new (short) names
names(survey_01) <- new_names


```

These data are 'wide', meaning that there are multiple variables for each respondent.
The data will be easier to visualize and analyze if we make the data 'longer'.

```{r}
survey_01_long <- survey_01 %>%
  tidyr::pivot_longer(.,
                      !c('Timestamp', 'Comments'),
                      names_to = "norm_counternorm",
                      values_to = "rating")
```

We should indicate whether these are norms, and label them "N", or counternorms, and label them "CN".

```{r}
survey_01_long <- survey_01_long %>%
  dplyr::mutate(., type = if_else(
    norm_counternorm %in% c(
      "Disinterestedness",
      "Organized Skepticism",
      "Communality",
      "Universalism"
    ),
    "Norm",
    "Counternorm"
  ))
```

Finally, there is a "test" set of responses that I used to test this data processing workflow.
We should delete those responses since they are nonsensical--I just hit random buttons to make some data.

```{r}
survey_01_long_clean <- survey_01_long %>%
  dplyr::filter(., is.na(Comments))
```

## Visualize data {-}

### What participants were asked {- #questions-asked}

>Perceptions of scientific practices
>
>The following statements reflect different values about how the scientific research community should function, according to studies of scientists’ work. Use the scale below to indicate the extent to which you personally feel it ACTUALLY REPRESENTS the behavior of most scientists.
>
> Source: Kardash, C. M. & Edwards, O. V. (2012). Thinking and behaving like scientists: Perceptions of undergraduate science interns and their faculty mentors. Instructional Science, 40(6), 875–899. https://doi.org/10.1007/s11251-011-9195-0.

```{r}
survey_qs %>%
  kableExtra::kable(., format='html')
```

### Unique respondents {-}

There appear to be $n=$ `r length(unique(survey_01_long$Timestamp))` respondents as of `r Sys.time()`.

### Rating distribution {-}

Remember, the rating scale was from 1: "not at all" to 5: "a great deal".

```{r fig-survey-01-responses, out.width="100%"}
survey_01_long %>% 
  ggplot() + 
  aes(norm_counternorm, rating, fill = type) + 
  geom_violin() +
  geom_point(position = position_jitter(width = .07, height = .07), alpha = 0.5) +
  coord_flip() +
  ggtitle("Ratings of scientists' adherence to norms and counternorms") +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank())
```

```{r fig-survey-01-norm-counter, out.width="100%"}
survey_01_long %>% 
  ggplot() + 
  aes(type, rating, fill = type) + 
  geom_violin() +
  geom_point(position = position_jitter(width = .07, height = .07), alpha = 0.5)
```

```{r fig-survey-01-cum-sum}
survey_01 %>%
  dplyr::mutate(., n_cum = seq_along(Timestamp)) %>%
  dplyr::mutate(., Timestamp = lubridate::mdy_hms(survey_01$Timestamp)) %>%
  ggplot() + 
  aes(Timestamp, n_cum) +
  geom_point() +
  geom_line()
```

